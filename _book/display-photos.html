
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>#1: Gallery 101. Display photos Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="upload-photos.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="display-photos.html">
            
                <a href="display-photos.html">
            
                    
                    #1: Gallery 101. Display photos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="upload-photos.html">
            
                <a href="upload-photos.html">
            
                    
                    #2: More interaction! Upload photos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="display-new-images.html">
            
                <a href="display-new-images.html">
            
                    
                    #3: Merging Observables. Display uploaded photos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="add-categories.html">
            
                <a href="add-categories.html">
            
                    
                    #4: Filtering data. Add categories
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >#1: Gallery 101. Display photos</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>Hi there! If you&#x2019;re reading this I know you&#x2019;ve already built some web applications and it went pretty well! You know how to store and display data. You know how to react to user events and communicate with servers. Even styling your applications gets easier every time you do it!</p>
<p>Today we&#x2019;ll dig deeper into managing user and server interaction. With Rx.js you&#x2019;ll take control of time in your application. You&#x2019;ll create <code>Observables</code> to easily merge, filter, and synchronize events happening in your application. Let&#x2019;s go!</p>
<h1 id="photo-gallery">Photo gallery</h1>
<p>We&#x2019;re starting with simple photo gallery. To create it we need one service and two components. </p>
<p>Photos service will start with one field: <code>photos</code>. It&apos;s an array with a bunch of example photos. First we&apos;re gonna use it to display our gallery. Later we&apos;ll, gradually, add Observables and interactvity, based on this array with photos.</p>
<p>Our Photo interface looks like that:</p>
<pre><code class="lang-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> Photo {
    url: <span class="hljs-built_in">string</span>;
    description: <span class="hljs-built_in">string</span>;
    id: <span class="hljs-built_in">string</span>;
    categoryID?: <span class="hljs-built_in">string</span>;
}
</code></pre>
<p>so <code>photos</code> in Photos service has type <code>Photo[]</code>. Gallery component refers photos list</p>
<pre><code class="lang-typescript">photosList: Photo[] = <span class="hljs-keyword">this</span>.photosService.photos;
</code></pre>
<p>and displays it using <code>*ngFor*</code></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;photos-list&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">&quot;let photo of photosList&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;photo&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">app-photo</span> [<span class="hljs-attr">photo</span>]=<span class="hljs-string">&quot;photo&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-photo</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>As you see there&apos;s one component left to implement. <code>app-photo</code> that displays single photo. In component code we declare one <code>Input</code></p>
<pre><code class="lang-typescript">@Input() photo: { description: <span class="hljs-built_in">string</span>; };
</code></pre>
<p>and use this data in HTML template</p>
<pre><code class="lang-typescript">&lt;img (click)=<span class="hljs-string">&quot;onPhotoClick(photo.id)&quot;</span> [src]=<span class="hljs-string">&quot;photo.url&quot;</span>&gt;
</code></pre>
<h2 id="first-observable">First Observable!</h2>
<p>Our photo gallery looks great, but all photos are so small. Users will want to see bigger pictures. Let&#x2019;s help them do so! When users click on photo we&#x2019;ll create a nice overlay over our gallery and show the whole photo.</p>
<p>To do it we have to track which photo is currently active. How do we do it? Of course, with help of Rx.js! It provides us with <code>BehaviorSubject</code> &#x2013; object that holds value changing over time. Once we&#x2019;ve had created BehaviorSubject that stores ID of active photo, we can display it easily.</p>
<pre><code class="lang-typescript">noPhotoID = <span class="hljs-string">&quot;&quot;</span>
activePhotoID$ = <span class="hljs-keyword">new</span> BehaviorSubject(<span class="hljs-keyword">this</span>.noPhotoID)
</code></pre>
<p>As you see, BehaviorSubject constructor takes one argument &#x2013; initial value. When we start to subscribe to activePhoto$ it will give us this value and, later, every next that comes to it. Our first value is empty string, since there&#x2019;s no active photo when application starts.</p>
<p>Let&#x2019;s now go to our gallery and change value of activePhotoID$ every time user clicks on photo.</p>
<pre><code class="lang-typescript">&lt;img (click)=<span class="hljs-string">&quot;onPhotoClick(photo.id)&quot;</span> [src]=<span class="hljs-string">&quot;photo.url&quot;</span>&gt;
</code></pre>
<p>We already know what&#x2019;s going on here. Once user clicks on photo, we&#x2019;re going to call the <code>onPhotoClick</code> method with one argument: photo.id. How do we implement <code>onPhotoClick</code> to make sure it sends value to activePhotoID$? We can do so like this:</p>
<pre><code class="lang-typescript">onPhotoClick(photoID: <span class="hljs-built_in">string</span>) {
    <span class="hljs-keyword">this</span>.photosService.activePhotoID$.next(photoID)
}
</code></pre>
<p>Just refer the <code>activePhotoID$</code> and call <code>next</code> on it! Great! You&#x2019;ve just connected user event with <code>Observable</code>. Now you can subscribe to it and display active photo.</p>
<h1 id="creating-new-value-from-observable">Creating new value from Observable</h1>
<p>To display active photo let&#x2019;s create a new component called (you guessed it) <code>active-photo</code>. It will access a photo that is currently active and display it.</p>
<p>But, you probably thinking now, in our photos service, we only store the ID of the photo. Our component needs entire Photo object! Let&#x2019;s take our <code>activePhotoID$</code> and create new Observable out of it.</p>
<pre><code class="lang-typescript">activePhoto$: Observable&lt;Photo&gt; = <span class="hljs-keyword">this</span>.activePhotoID$.pipe(
    map(photoID =&gt; <span class="hljs-keyword">this</span>.photos.find(propEq(<span class="hljs-string">&quot;id&quot;</span>, photoID))
)
</code></pre>
<p>Only three lines of code and we&#x2019;re done! Let&#x2019;s break down what happens in activePhoto$.</p>
<p>First: we&#x2019;re accessing current active photo ID. Second: we&#x2019;re using <code>pipe</code> method to transform it into something new. That&#x2019;s what <code>pipe</code> does. It takes value from Observable and pipes it through Rx.js operators that create new Observables. Our first <code>pipe</code> takes photo ID and maps it to Photo object. Third: we take array of photos and return one Photo whose <code>id</code> equals <code>photoID</code>. Function <code>propEq</code> says exactly that: check if property named <code>id</code> equals variable <code>photoID</code>.</p>
<p>Let&#x2019;s break this process down even further. Let&#x2019;s extract a method that takes photo ID and returns Photo. It looks like this:</p>
<pre><code class="lang-typescript">findPhotoByID = (photos: Photo[], photoID: <span class="hljs-built_in">string</span>) =&gt;
    photos.find(propEq(<span class="hljs-string">&quot;id&quot;</span>, photoID))
</code></pre>
<p>We&#x2019;re just finding one photo in array. Now, move it back to our <code>activePhoto$</code> Observable.</p>
<pre><code class="lang-typescript">activePhoto$: Observable&lt;Photo&gt; = <span class="hljs-keyword">this</span>.activePhotoID$.pipe(
    map(<span class="hljs-keyword">this</span>.findPhotoByID)
)
</code></pre>
<p>Take active photo ID, pipe it through <code>map</code> operator and return new Observable that finds photo based on ID.</p>
<p>Go on and use <code>activePhoto$</code> Observable to display photo that user wanted to see!</p>
<h2 id="display-active-photo">Display active photo!</h2>
<p>It gets more and more interesting! You created <code>BehaviorSubject</code> that keeps value changing over time. You&#x2019;ve used it to create new Observable! Now you get to display data from it. It surely requires a lot of work, or does it&#x2026;? Let&#x2019;s look at the code.</p>
<pre><code class="lang-typescript">activePhoto$: Observable&lt;Photo&gt; = <span class="hljs-keyword">this</span>.photosService.activePhoto$;
</code></pre>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> *<span class="hljs-attr">ngIf</span>=<span class="hljs-string">&quot;(activePhoto$ | async)&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;active-photo&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> [<span class="hljs-attr">src</span>]=<span class="hljs-string">&quot;(activePhoto$ | async)?.url&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>And we have it with a couple lines of code! You assign <code>activePhoto$</code> from Photos service to Component field, so we can access <code>activePhoto$</code> value in HTML. Because we access asynchronous value that changes over time we use <code>async</code> pipe. Now Angular knows it should subscribe to asynchronous value and use new value every time it changes. Last part <code>?.url</code> means: check if <code>activePhoto$</code> holds a value, if it does access <code>url</code> field from it and display in HTML. Whew! We did it!</p>
<h2 id="hiding-active-photo">Hiding active photo</h2>
<p>Last thing to do is hiding photo! It&apos;s nice that user can see bigger photos, but refreshing application every time one wants to change photo preview would be a little&#x2026; cumbersome ;)</p>
<p>To hide active photo we need to put empty ID on <code>activePhotoID$</code> <code>BehaviorSubject</code>. This way Photos service will know to send our components <code>undefined</code> value through <code>activePhoto$</code> Observable and no photo will be displayed.</p>
<p>Ok, first let&apos;s add <code>hidePhoto</code> handler to HTML element, like that:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
    *<span class="hljs-attr">ngIf</span>=<span class="hljs-string">&quot;(activePhoto$ | async)&quot;</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;active-photo&quot;</span>
    (<span class="hljs-attr">click</span>)=<span class="hljs-string">&quot;hidePhoto()&quot;</span>
&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> [<span class="hljs-attr">src</span>]=<span class="hljs-string">&quot;(activePhoto$ | async)?.url&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Active photo is now ready to receive user clicks. Now we go to Component and implement our handler.</p>
<pre><code class="lang-typescript">hidePhoto() {
    <span class="hljs-keyword">this</span>.photosService.activePhotoID$.next(<span class="hljs-keyword">this</span>.photosService.noPhotoID);
}
</code></pre>
<p>Looks almost like setting active Photo ID, we&apos;ve done in Photo Component. Only difference is, this time we&apos;re sending <code>noPhotoID</code> instead of real ID. This way no active photo is displayed! What more can we do with our gallery? Maybe&#x2026; let&apos;s try adding some photos!</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Introduction">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="upload-photos.html" class="navigation navigation-next " aria-label="Next page: #2: More interaction! Upload photos">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"#1: Gallery 101. Display photos","level":"1.2","depth":1,"next":{"title":"#2: More interaction! Upload photos","level":"1.3","depth":1,"path":"upload-photos.md","ref":"upload-photos.md","articles":[]},"previous":{"title":"Introduction","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"display-photos.md","mtime":"2019-09-27T09:04:01.494Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-09-27T09:20:36.754Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

